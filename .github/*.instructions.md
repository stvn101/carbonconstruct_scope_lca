# ðŸ§  CARBONCONSTRUCT GITHUB COPILOT INSTRUCTIONS

> **Repository:** `stvn101/carbonconstruct_scope_lca`  
> **Owner:** CarbonConstruct Tech (Â© 2025)  
> **Purpose:** Instruct GitHub Copilot to act as a disciplined, context-aware development assistant for the CarbonConstruct ecosystem â€” producing only secure, standards-compliant, ISO-aligned code and documentation.

---

## ðŸ§© Mission Context

CarbonConstruct is a sustainability SaaS platform built for the Australian construction sector.  
It automates **carbon accounting, LCA analysis, EPD integration, and compliance** with:

- ISO 14040 / 14044  
- NCC 2025 Section J  
- GBCA Green Star v2.0  
- GHG Protocol Scopes 1â€“3  

The platform integrates:

- Next.js 14 + TypeScript  
- TailwindCSS + shadcn/ui  
- Supabase (PostgreSQL)  
- Stripe Billing  
- EC3 API  
- ISO-compliant LCA engine  

Copilot must support this mission through precision, modularity, and safety.

---

## âš™ï¸ Behavioral Directives

### 1. Code Quality
- Enforce strict TypeScript (`"strict": true`).
- Descriptive variable names only.
- Pure functions; side effects in API or hooks.
- Destructure props; never mutate inputs.
- Follow ESLint + Prettier rules.

### 2. Security & Compliance
- Never log or expose secrets.
- Use env vars for all credentials.
- Respect Supabase RLS.
- Validate all input (Zod or schema).
- Sanitize all output.
- Follow ISO 14044 lifecycle principles.

### 3. Data Layer
- Supabase (PostgreSQL) backend.
- Define migrations under `/supabase/migrations/`.
- No raw SQL inside React.
- Use `from().select().eq()` exclusively.
- No destructive commands (`DROP`, `DELETE`, `TRUNCATE`, `ALTER`).
- Use typed Supabase queries.

### 4. API Development
- All endpoints in `/pages/api/`.
- Route format: `/api/{domain}/{function}.ts`
- Each endpoint includes:
  1. Input validation.
  2. Auth guard.
  3. Error handling returning `{ status, data, error }`.
- Cache + rate-limit EC3 API calls.
- Stripe: server-side only.

### 5. Front-End Rules
- Components: `/src/components`
- Stateless, functional, typed.
- Hooks: `/src/hooks`, logic-only.
- State: Zustand or Context.
- Tailwind theme:  
  - Green `#1B5E20`  
  - Lime `#C6FF00`  
  - Charcoal `#212121`
- Must include GBCA + EC3 logos in footer.

### 6. Testing Strategy
- Jest (unit) + Playwright (integration).
- Coverage â‰¥ 90 %.
- Mock Supabase & EC3 API.
- Use `.env.test`.
- Run `npm run lint && npm run type-check` before commit.

### 7. Build & Deployment
- Environments: `.env.local`, `.env.development`, Vercel secrets.
- CI pipeline via GitHub Actions (`.github/workflows/ci.yml`).
- On PR: build â†’ lint â†’ test â†’ preview.
- On merge â†’ auto deploy to production.
- Block merge on error.

### 8. Documentation & Style
- JSDoc or TSDoc header for every exported function.
- Keep `README.md` and `/docs/CHANGELOG.md` updated.
- Complex logic â†’ add diagrams or examples.

### 9. File Hierarchy
```

carbonconstruct_scope_lca/
â”œâ”€â”€ .github/
â”‚   â”œâ”€â”€ workflows/
â”‚   â”‚   â”œâ”€â”€ ci.yml
â”‚   â”‚   â””â”€â”€ deploy.yml
â”‚   â”œâ”€â”€ ISSUE_TEMPLATE/
â”‚   â”‚   â””â”€â”€ feature_request.md
â”‚   â””â”€â”€ copilot.instructions.md
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ pages/api/
â”‚   â””â”€â”€ styles/
â”œâ”€â”€ supabase/
â”‚   â”œâ”€â”€ migrations/
â”‚   â”œâ”€â”€ policies/
â”‚   â””â”€â”€ functions/
â”œâ”€â”€ data/
â”œâ”€â”€ tests/
â””â”€â”€ docs/

```

### 10. Commit & Branch Policy
- Branches:  
  - `feature/*` â€“ new modules  
  - `fix/*` â€“ bug patches  
  - `chore/*` â€“ maintenance  
- Commit format:
```

feat: add carbon factor API integration
fix: resolve EC3 OAuth refresh token issue
chore: update RLS policy comments

````
- PR must link to issue ID.

### 11. Performance
- Lazy-load heavy components.  
- Cache API calls (SWR or React Query).  
- Index Supabase columns.  
- Memoize expensive computations.  
- Use Next/Image for assets.

### 12. Accessibility & UX
- WCAG 2.1 AA compliant.  
- Semantic HTML (`main`, `header`, `footer`).  
- Real-time form validation.  
- Mobile â‰¥ 360 px breakpoint.

### 13. Logging & Error Policy
- Central logger: `/lib/logger.ts`.
- Structured log object: `{ level, context, message, error }`.
- Disable console in production.
- Hook server errors to Slack/webhook.

### 14. Compliance & LCA Logic
- Each emission factor must trace to source (EPD, EC3, openEPD).
- Implement GHG Scopes 1â€“3 logic accurately.
- Preserve LCA stage labels (A1â€“A5, B1â€“C4, D).
- Support Green Star â€œUpfront Carbonâ€ credits.

### 15. Branding
- Logos in `/public/branding/`.
- Fonts: Inter or system sans-serif.
- Green header bars for reports.

---

## ðŸš« Hard Restrictions
- No raw SQL or schema mutations.  
- No untyped JavaScript.  
- No `.env` commits.  
- No inline styles or duplicated classes.  
- No secret key exposure.

---

## âœ… Completion Checklist

| Task Type | Criteria | Status |
|------------|-----------|--------|
| API Route | Validated + Auth + Tested | â˜ |
| DB Migration | Safe + Versioned + Rollback | â˜ |
| UI Component | Accessible + Responsive | â˜ |
| Tests | â‰¥ 90 % coverage | â˜ |
| Docs | Updated + Linked | â˜ |
| Deploy | CI/CD Pass | â˜ |

---

## ðŸ” Reference Docs
- [Supabase Docs](https://supabase.com/docs)  
- [Stripe API](https://stripe.com/docs/api)  
- [EC3 API](https://buildingtransparency.org/ec3)  
- [GHG Protocol](https://ghgprotocol.org)  
- [GBCA Green Star](https://new.gbca.org.au/green-star)  

---

## ðŸ§­ Copilot Meta-Directives
- Prefer functional, typed code that compiles immediately.  
- Never suggest destructive operations.  
- Generate complete code blocks only.  
- Default TypeScript > JavaScript.  
- Comment only to clarify logic or dependency.

---

## ðŸ§± Enhancements

1. **`.github/workflows/deploy.yml`**  
 - Automate build â†’ test â†’ deploy to Netlify or Vercel.  
 - Include caching and rollback steps.  
 - Trigger on push to `main` and tag release.

2. **`.github/ISSUE_TEMPLATE/feature_request.md`**  
 - Collect feature scope, impact, dependencies, and priority.  
 - Template:
   ```markdown
   ---
   name: Feature Request
   about: Suggest a new capability for CarbonConstruct
   labels: feature
   ---

   ## Summary
   _Describe the feature clearly._

   ## Motivation
   _What problem does this solve?_

   ## Dependencies
   _Any APIs, DB changes, or services required?_

   ## Acceptance Criteria
   - [ ] Meets CarbonConstruct code standards
   - [ ] Tested and documented
   - [ ] Non-destructive
   ```

---

**End of File**  
`carbonconstruct_scope_lca/.github/copilot.instructions.md`
````
